<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0) on Fri May 09 07:22:34 CEST 2014 -->
<title>GracefulShutdownMonitor (gpars 1.2.1)</title>
<meta name="date" content="2014-05-09">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="GracefulShutdownMonitor (gpars 1.2.1)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/GracefulShutdownMonitor.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownListener.html" title="class in groovyx.gpars.dataflow.operator.component"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../groovyx/gpars/dataflow/operator/component/OperatorStateMonitor.html" title="interface in groovyx.gpars.dataflow.operator.component"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html" target="_top">Frames</a></li>
<li><a href="GracefulShutdownMonitor.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">groovyx.gpars.dataflow.operator.component</div>
<h2 title="Class GracefulShutdownMonitor" class="title">Class GracefulShutdownMonitor</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>groovyx.gpars.dataflow.operator.component.GracefulShutdownMonitor</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../../groovyx/gpars/dataflow/operator/component/OperatorStateMonitor.html" title="interface in groovyx.gpars.dataflow.operator.component">OperatorStateMonitor</a></dd>
</dl>
<hr>
<br>
<pre>public final class <span class="strong">GracefulShutdownMonitor</span>
extends java.lang.Object
implements <a href="../../../../../groovyx/gpars/dataflow/operator/component/OperatorStateMonitor.html" title="interface in groovyx.gpars.dataflow.operator.component">OperatorStateMonitor</a></pre>
<div class="block">The monitor will orchestrate a graceful shutdown, when its shutdownNetwork() method is called.
 For this mechanism to work, all selectors/operators in the network have to have their own instance of GracefulShutdownListener added
 and these listeners have to share the same GracefulShutdownMonitor instance.
 Each listener observes the activity in the input channels of its corresponding operator/selector. Upon graceful shutdown
 initialization, the listeners also start watching the state of their operators/selectors.
 The GracefulShutdownMonitor then repeatedly watches, whether listeners report activity in the operators.
 When the activity ceases, the monitor will poll all listeners about the state of their operator/selector and its input channels.
 If all listeners report no activity and no incoming messages, the monitor can safely terminate all operators.</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>Vaclav Pech</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static long</code></td>
<td class="colLast"><code><strong><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html#DEFAULT_DELAY">DEFAULT_DELAY</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html#delay">delay</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.Collection&lt;<a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownListener.html" title="class in groovyx.gpars.dataflow.operator.component">GracefulShutdownListener</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html#listeners">listeners</a></strong></code>
<div class="block">All listeners that watch the operators/selectors in the network</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.util.concurrent.atomic.AtomicBoolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html#notificationArrivedFlag">notificationArrivedFlag</a></strong></code>
<div class="block">Indicates, whether some activity has been reported since last time</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../groovyx/gpars/dataflow/DataflowVariable.html" title="class in groovyx.gpars.dataflow">DataflowVariable</a>&lt;java.lang.Boolean&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html#result">result</a></strong></code>
<div class="block">The final latch that indicates the network has been shutdown</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html#shutdownFlag">shutdownFlag</a></strong></code>
<div class="block">Indicates whether shutdown has been initialized</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html#GracefulShutdownMonitor()">GracefulShutdownMonitor</a></strong>()</code>
<div class="block">Uses the default timer delay</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><strong><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html#GracefulShutdownMonitor(long)">GracefulShutdownMonitor</a></strong>(long&nbsp;delay)</code>
<div class="block">Allows to use a customized delay</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html#checkWhetherAnyEventsHaveArrived()">checkWhetherAnyEventsHaveArrived</a></strong>()</code>
<div class="block">Checks the notification flag whether there has been some activity since last timer run.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html#onTimer()">onTimer</a></strong>()</code>
<div class="block">Checks, whether the network is no longer active.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html#registerProcessorListener(groovyx.gpars.dataflow.operator.component.GracefulShutdownListener)">registerProcessorListener</a></strong>(<a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownListener.html" title="class in groovyx.gpars.dataflow.operator.component">GracefulShutdownListener</a>&nbsp;listener)</code>
<div class="block">Invoked by GracefulShutdownListeners, which listen on operators/selectors for lifecycle events, to get registered with the monitor.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html#schedule()">schedule</a></strong>()</code>
<div class="block">Clears the notification flag so as we know whether some activity happens between subsequent checks.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../groovyx/gpars/dataflow/Promise.html" title="interface in groovyx.gpars.dataflow">Promise</a>&lt;java.lang.Boolean&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html#shutdownNetwork()">shutdownNetwork</a></strong>()</code>
<div class="block">Initializes the shutdown process.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html#stateChanged()">stateChanged</a></strong>()</code>
<div class="block">Invoked whenever a processor changes state</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="DEFAULT_DELAY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEFAULT_DELAY</h4>
<pre>private static final&nbsp;long DEFAULT_DELAY</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../constant-values.html#groovyx.gpars.dataflow.operator.component.GracefulShutdownMonitor.DEFAULT_DELAY">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="delay">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>delay</h4>
<pre>private final&nbsp;long delay</pre>
</li>
</ul>
<a name="shutdownFlag">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>shutdownFlag</h4>
<pre>private&nbsp;boolean shutdownFlag</pre>
<div class="block">Indicates whether shutdown has been initialized</div>
</li>
</ul>
<a name="notificationArrivedFlag">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>notificationArrivedFlag</h4>
<pre>private final&nbsp;java.util.concurrent.atomic.AtomicBoolean notificationArrivedFlag</pre>
<div class="block">Indicates, whether some activity has been reported since last time</div>
</li>
</ul>
<a name="result">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>result</h4>
<pre>private final&nbsp;<a href="../../../../../groovyx/gpars/dataflow/DataflowVariable.html" title="class in groovyx.gpars.dataflow">DataflowVariable</a>&lt;java.lang.Boolean&gt; result</pre>
<div class="block">The final latch that indicates the network has been shutdown</div>
</li>
</ul>
<a name="listeners">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>listeners</h4>
<pre>private final&nbsp;java.util.Collection&lt;<a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownListener.html" title="class in groovyx.gpars.dataflow.operator.component">GracefulShutdownListener</a>&gt; listeners</pre>
<div class="block">All listeners that watch the operators/selectors in the network</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="GracefulShutdownMonitor()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>GracefulShutdownMonitor</h4>
<pre>public&nbsp;GracefulShutdownMonitor()</pre>
<div class="block">Uses the default timer delay</div>
</li>
</ul>
<a name="GracefulShutdownMonitor(long)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>GracefulShutdownMonitor</h4>
<pre>public&nbsp;GracefulShutdownMonitor(long&nbsp;delay)</pre>
<div class="block">Allows to use a customized delay</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>delay</code> - A timeout in milliseconds to wait between two subsequent polls on processors' state.
              Lower values will reduce the wait time for network shutdown,
              but maz have impact on the performance when the shutdown process gets initialized.</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="stateChanged()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stateChanged</h4>
<pre>public&nbsp;void&nbsp;stateChanged()</pre>
<div class="block">Invoked whenever a processor changes state</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../groovyx/gpars/dataflow/operator/component/OperatorStateMonitor.html#stateChanged()">stateChanged</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../groovyx/gpars/dataflow/operator/component/OperatorStateMonitor.html" title="interface in groovyx.gpars.dataflow.operator.component">OperatorStateMonitor</a></code></dd>
</dl>
</li>
</ul>
<a name="registerProcessorListener(groovyx.gpars.dataflow.operator.component.GracefulShutdownListener)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>registerProcessorListener</h4>
<pre>public&nbsp;void&nbsp;registerProcessorListener(<a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownListener.html" title="class in groovyx.gpars.dataflow.operator.component">GracefulShutdownListener</a>&nbsp;listener)</pre>
<div class="block">Invoked by GracefulShutdownListeners, which listen on operators/selectors for lifecycle events, to get registered with the monitor.
 The monitor will query these registered listeners about their respective operator/selector state when performing graceful shutdown.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../groovyx/gpars/dataflow/operator/component/OperatorStateMonitor.html#registerProcessorListener(groovyx.gpars.dataflow.operator.component.GracefulShutdownListener)">registerProcessorListener</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../groovyx/gpars/dataflow/operator/component/OperatorStateMonitor.html" title="interface in groovyx.gpars.dataflow.operator.component">OperatorStateMonitor</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>listener</code> - The listener to register</dd></dl>
</li>
</ul>
<a name="shutdownNetwork()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>shutdownNetwork</h4>
<pre>public&nbsp;<a href="../../../../../groovyx/gpars/dataflow/Promise.html" title="interface in groovyx.gpars.dataflow">Promise</a>&lt;java.lang.Boolean&gt;&nbsp;shutdownNetwork()</pre>
<div class="block">Initializes the shutdown process.
 New listeners cannot be registered after this point.
 New messages should not enter the dataflow network from the outside, since this may prevent the network from terminating.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>A Promise, which may be used to wait for or get notified about the shutdown success.</dd></dl>
</li>
</ul>
<a name="onTimer()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>onTimer</h4>
<pre>void&nbsp;onTimer()</pre>
<div class="block">Checks, whether the network is no longer active.
 To reduce effect on system performance, cheap criteria are being checked first.</div>
</li>
</ul>
<a name="checkWhetherAnyEventsHaveArrived()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkWhetherAnyEventsHaveArrived</h4>
<pre>private&nbsp;boolean&nbsp;checkWhetherAnyEventsHaveArrived()</pre>
<div class="block">Checks the notification flag whether there has been some activity since last timer run.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>True, if events have been registered since last time, false otherwise.</dd></dl>
</li>
</ul>
<a name="schedule()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>schedule</h4>
<pre>private&nbsp;void&nbsp;schedule()</pre>
<div class="block">Clears the notification flag so as we know whether some activity happens between subsequent checks.
 Schedules the timer to run again after the delay set on the monitor.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/GracefulShutdownMonitor.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>Copyright &#169; 2008&#8211;2013  V&#225;clav Pech.  All Rights Reserved.</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../groovyx/gpars/dataflow/operator/component/GracefulShutdownListener.html" title="class in groovyx.gpars.dataflow.operator.component"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../groovyx/gpars/dataflow/operator/component/OperatorStateMonitor.html" title="interface in groovyx.gpars.dataflow.operator.component"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?groovyx/gpars/dataflow/operator/component/GracefulShutdownMonitor.html" target="_top">Frames</a></li>
<li><a href="GracefulShutdownMonitor.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
